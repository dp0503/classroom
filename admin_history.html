<!doctype html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Classroom â€” Admin History</title>
	<link rel="preconnect" href="https://fonts.googleapis.com">
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
	<link rel="stylesheet" href="assets/css/styles.css">
</head>
<body>
	<header class="site-header">
		<div class="container nav">
			<div class="brand"><div class="brand-logo" aria-hidden="true"></div><span>Classroom</span></div>
			<nav class="nav-actions" aria-label="Primary">
				<a class="btn btn-ghost" href="admin.html">Users</a>
				<a class="btn btn-primary" href="login.html">Logout</a>
			</nav>
		</div>
	</header>
	<main class="section">
		<div class="container">
			<h1 style="margin-top:0">Audit History</h1>
			<table class="table" aria-label="Audit log">
				<thead><tr><th>When</th><th>Action</th><th>By</th><th>Details</th></tr></thead>
				<tbody id="auditBody"></tbody>
			</table>
		</div>
	</main>
	<script src="assets/js/app.js"></script>
	<script>
		window.addEventListener('DOMContentLoaded',()=>{
			if(!window.App) return; App.guard('admin');
			const body=document.getElementById('auditBody');
			App.api('/admin/audit/logs').then(rows=>{
				body.innerHTML='';
				[...rows].reverse().forEach(r=>{
					const tr=document.createElement('tr');
					tr.innerHTML=`<td>${r.created_at}</td><td>${r.action}</td><td>${r.performed_by}</td><td><pre style='white-space:pre-wrap;margin:0'>${JSON.stringify(r.details)}</pre></td>`;
					body.appendChild(tr);
				});
			}).catch(e=>alert(e.message));
		});
	</script>
</body>
</html>

